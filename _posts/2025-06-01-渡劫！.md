---
title: 渡劫！
author: 凉香栾
date: 2025-06-01 11:24:26 +0800
categories:
  - 算法题解
tags:
  - 回溯
description: 回溯系列参考题解二
toc: true
pin: false
math: true
mermaid: true
comment: true
media_subpath:
---


## 题目描述

为了击败大魔王Cat，修仙者大英雄Bat收集了大量具有灵力的兽骨，准备渡劫。每根兽骨都有各自的长度。

Bat需要将所有兽骨首尾相连，形成等长的“天”、“地”、“人”三脉，才能渡劫成功。简单来说，就是用所有给定的兽骨长度，判断它们能否构成一个等边三角形。


> **输入**
> 第一行为兽骨的数量 `N`（`N` 不超过100）。 
> 之后是一行 `N` 个正整数，以**不增顺序**给出，表示各根兽骨的长度。
> **输出**
> 如果Bat可以渡劫成功输出"YES"；否则输出"NO"。 


## 解题思路

本质是**集合划分问题**，我们需要判断给定的 `N` 个整数能否被划分成3个总和相等的子集。

当然，想要有解必须满足以下条件：
1.  所有兽骨的总长度 `sum`必须能被3整除。
2.  目标长度 `len = sum / 3`，在第`i`条边上放入第`k`根骨头， `l[i] + a[k]` 不能超过目标长度 `len` 。

递归地尝试即可，如果失败了就尝试下一条边，直到无边可试。

## 附AC代码

```cpp
#include <iostream>
using namespace std;
int n, sum, len,a[101];

bool dfs(int p, int l[3]) {
    if (p == n) return true;
    for (int i = 0; i < 3; ++i) {
        if (l[i] + a[p] <= len) {
            l[i] += a[p];
            if (dfs(p + 1, l)) return true;
            l[i] -= a[p];
        }
        if (l[i] == 0) break;
    }
    return false;
}

int main() {
    cin >> n;
    for (int i = 0; i < n; ++i) {
        cin >> a[i];
        sum += a[i];
    }
    if (sum % 3 != 0 || a[0] > sum / 3) {
        cout << "NO" << endl;
        return 0;
    }
    len = sum / 3;
    int l[3] = {0};
    cout << (dfs(0, l) ? "YES" : "NO") << endl;
    return 0;
}

```