---
title: 数值表示：原码、补码、反码和移码
author: 凉香栾
date: 2025-10-05 11:28:25 +0800
categories:
  - 组成原理
tags:
  - 组成原理
description: 介绍计算机中央处理器中整数和定点小数的表示方法。
toc: true
pin: false
math: true
mermaid: true
comment: true
---

## 数值表示

### 1. 原码（True Form, TF）

* **整数**：

$$
[x]_{\text{TF}} =
\begin{cases}
x, & 0 \le x < 2^{n-1} \\
2^{n-1} - x, & -2^{n-1} \le x < 0
\end{cases}
$$


* **小数**：

$$
[x]_{\text{TF}} =
\begin{cases}
x, & 0 \le x < 1 \\
1 - x, & -1 \le x < 0
\end{cases}
$$

### 2. 补码（Two’s complement, 2’）

计算机能够直接进行加法运算，但减法运算相对复杂。为了简化硬件设计，人们引入了补码（two’s complement），将负数用它的补数表示，从而把减法运算转化为加法运算。

> [!NOTE]
> **补的概念**
> 
> 假设我们有一个整数范围 $0 \sim M-1$，其中 $M$ 是模数（modulus），那么对于$x \in [0, M-1]$，我们称$[-x] = M - x$是$-x$的补数，补数总是正的，就像钟表刻度，不论指针是从哪个方向转过来的，都不影响对当前刻度的指示。
> 
> 一个负数可用它的正补数来代替，而这个正补数可以用模加上负数本身求得。
> 
> 一个正数和一个负数互为补数时，它们绝对值之和即为模数。
> 
> 正数的补数即该正数本身。

具体来说，对于一个整数 $x$，其补码表示为 $2^n - x \pmod {2^n}$。这样，当我们需要计算 $a - b$ 时，可以将其改写为加法形式：

$$
a - b = a + (-b) = a + [b]_\text{2’} \pmod{2^n}
$$

整数和小数的补码与其真值换算公式如下：

* **整数**：

$$
[x]_{\text{2'}} =
\begin{cases}
x, & 0 \le x < 2^n \\
2^{n+1} + x \pmod{2^{n+1}}, & -2^n \le x < 0
\end{cases}
$$

* **小数**：

$$
[x]_{\text{2'}} =
\begin{cases}
x, & 0 \le x < 1 \\
2 + x \pmod{2}, & -1 \le x < 0
\end{cases}
$$


> [!NOTE]
> **补码是加法封闭的**
> 
> 可能有人会问，凭什么认为补码相加还是补码呢？直观来说，补码系统就是 $\mathbb{Z}_{2^n}$，它本来就是一个封闭的加法群，所以加法一定是封闭的。

**计算补码只需要原码按位取反再加$1$即可。**

### 3. 反码（One’s complement, 1’）

* **整数**：

$$
[x]_{\text{1'}} =
\begin{cases}
x, & 0 \le x < 2^n \\
(2^{n+1}-1) + x \pmod{2^{n+1}-1}, & -2^n < x \le 0
\end{cases}
$$

* **小数**：

$$
[x]_{\text{1'}} =
\begin{cases}
x, & 0 \le x < 1 \\
(2 - 2^{-n}) + x \pmod{2 - 2^{-n}}, & -1 < x \le 0
\end{cases}
$$

按照定义，反码就是原码按位取反。因此结合补码计算规则有

$$
[x]_{2'} = [x]_{1'} + 1
$$

因为设计补码的目标是简化四则运算的计算，因此求补码本身也不能太困难。有了反码和上述公式之后，求补码变得很简单，因为按位取反是很简单的运算。*（这不但对于计算机来说意义重大，对我们来说也一样，因为求反码对我们来说也是很简单的运算。）*


### 4. 移码（Bias code, B）

$$
[x]_{\text{B}} = 2^n + x, \quad -2^n \le x < 2^n
$$


### 一些特殊值
以五位为例

|   二进制    |       原码真值       |       反码真值        |       补码真值       | 移码真值（bias=2⁴−1=15） |
| :------: | :--------------: | :---------------: | :--------------: | :----------------: |
| `0,0000` |       $+0$       |       $+0$        |       $+0$       |       $−15$        |
| `1,0000` |       $−0$       |       $−15$       |      $−16$       |        $+0$        |
| `1,1111` |      $−15$       |       $−0$        |       $−1$       |       $+16$        |
| `0.0000` |       $+0$       |       $+0$        |       $+0$       | $− \frac{15}{16}$  |
| `1.0000` |       $−0$       | $− \frac{15}{16}$ |       $−1$       |        $+0$        |
| `1.1111` | $-\frac{15}{16}$ |       $−0$        | $− \frac{1}{16}$ |        $+1$        |


